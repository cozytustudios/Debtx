<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Debtx | Digital Khata for Bangladeshi Shopkeepers</title>
    <link rel="stylesheet" href="style.css" />
    <link rel="manifest" href="manifest.json" />
    <link rel="icon" type="image/png" href="iconx.png" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+Bengali:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script>
        // Early helper: if skipLoginNow is ready, call it; otherwise mark intent
        window.__pendingSkipLogin = false;
        window.skipLoginNow = window.skipLoginNow || function() {
            window.__pendingSkipLogin = true;
            console.log('skipLoginNow queued (will run when app loads)');
        };
    </script>
</head>
<body>
    <!-- Login screen removed: login is now managed from Settings only -->


    <div class="app" id="app">
        <header class="app-header">
            <div class="app-title">
                <span class="title-en">Debtx</span>
                <span class="title-bn">‡¶°‡ßá‡¶¨‡¶ü‡¶è‡¶ï‡ßç‡¶∏</span>
            </div>
            <button class="settings-toggle" id="settings-toggle" aria-label="Settings">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="3"></circle>
                    <path d="M12 1v6m0 6v6M5.64 5.64l4.24 4.24m4.24 4.24l4.24 4.24M1 12h6m6 0h6M5.64 18.36l4.24-4.24m4.24-4.24l4.24-4.24"></path>
                </svg>
            </button>
        </header>
        <div class="app-hero glass-card">
            <div class="app-hero__text">
                <p>Optichain ¬∑ Digital Khata</p>
                <h2>Keep track of dues, notes, and premium AI guidance.</h2>
                <p>Get a walkthrough, install the PWA, and keep your shop moving.</p>
                <div class="app-hero__actions">
                    <button class="primary-btn" id="install-app-btn" disabled>Install App</button>
                    <button class="secondary-btn" id="learn-app-btn">How it works</button>
                </div>
            </div>
            <div class="app-hero__stats">
                <div class="stat-card">
                    <span>Customers</span>
                    <strong id="stat-customers-count">0</strong>
                    <small>Active profiles</small>
                </div>
                <div class="stat-card">
                    <span>Notes</span>
                    <strong id="stat-notes-count">0</strong>
                    <small>Ideas captured</small>
                </div>
                <div class="stat-card">
                    <span>Pending tasks</span>
                    <strong id="stat-tasks-count">0</strong>
                    <small>Due soon</small>
                </div>
            </div>
        </div>

        <main class="app-main">
            <section class="panel active" id="panel-customers" aria-label="Customer debts">
                <div class="panel-header">
                    <div>
                        <h1 data-i18n="customers.title">Customers & Debts</h1>
                        <p class="panel-subtitle" data-i18n="customers.subtitle">Track dues, payments, and reminders</p>
                    </div>
                    <button class="primary-btn" id="add-customer-btn" data-i18n="customers.addCustomer">+ Add Customer</button>
                </div>

                <div class="search-bar">
                    <input type="search" id="customer-search" placeholder="Search by name or phone" data-i18n-placeholder="customers.searchPlaceholder" />
                </div>

                <div class="data-empty" id="customers-empty" hidden>
                    <p data-i18n="customers.empty">No customers yet. Add the first customer to begin.</p>
                </div>

                <div class="cards" id="customer-list" aria-live="polite"></div>
            </section>

            <section class="panel" id="panel-notes" aria-label="Shop notes">
                <div class="panel-header">
                    <div>
                        <h1 data-i18n="notes.title">Shop Notes</h1>
                        <p class="panel-subtitle" data-i18n="notes.subtitle">Keep quick reminders in one place</p>
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <button class="secondary-btn" id="notes-search-btn" aria-label="Search Notes">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="11" cy="11" r="8"></circle>
                                <path d="m21 21-4.35-4.35"></path>
                            </svg>
                        </button>
                        <button class="primary-btn" id="add-note-btn" data-i18n="notes.addNote">+ New Note</button>
                    </div>
                </div>

                <div class="search-bar" id="notes-search-bar" style="display: none;">
                    <input type="search" id="notes-search" placeholder="Search notes..." />
                </div>

                <div class="data-empty" id="notes-empty" hidden>
                    <p data-i18n="notes.empty">No notes saved yet. Start writing your ideas.</p>
                </div>

                <div class="cards" id="notes-list" aria-live="polite"></div>
            </section>

            <section class="panel" id="panel-tasks" aria-label="To-do list and reminders">
                <div class="panel-header">
                    <div>
                        <h1 data-i18n="tasks.title">To-Do & Reminders</h1>
                        <p class="panel-subtitle" data-i18n="tasks.subtitle">Watch payment dates and shop work</p>
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <button class="secondary-btn" id="tasks-filter-btn" aria-label="Filter Tasks">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
                            </svg>
                        </button>
                        <button class="primary-btn" id="add-task-btn" data-i18n="tasks.addTask">+ Add Task</button>
                    </div>
                </div>

                <div class="tasks-filter-bar" id="tasks-filter-bar" style="display: none;">
                    <button class="filter-btn active" data-filter="all">All</button>
                    <button class="filter-btn" data-filter="pending">Pending</button>
                    <button class="filter-btn" data-filter="completed">Completed</button>
                    <button class="filter-btn" data-filter="overdue">Overdue</button>
                    <button class="filter-btn" data-filter="done" id="view-done-tasks-btn">View Done</button>
                </div>

                <div class="calendar-hint">
                    <p data-i18n="tasks.calendarHint">Tap a date to see upcoming payments and tasks.</p>
                </div>

                <div class="calendar" id="mini-calendar" aria-label="Calendar view"></div>

                <div class="data-empty" id="tasks-empty" hidden>
                    <p data-i18n="tasks.empty">No tasks scheduled. Add reminders to stay on track.</p>
                </div>

                <div class="cards" id="tasks-list" aria-live="polite"></div>

                <div class="expense-section glass-card">
                    <div class="expense-header">
                        <div>
                            <h2>Shop Expense Tracker (Premium)</h2>
                            <p class="panel-subtitle">Track personal/shop expenses alongside dues.</p>
                        </div>
                        <div class="expense-totals">
                            <div>
                                <small>Total spend</small>
                                <strong id="expense-total">‡ß≥0</strong>
                            </div>
                            <div>
                                <small>This month</small>
                                <strong id="expense-month-total">‡ß≥0</strong>
                            </div>
                        </div>
                    </div>
                    <form class="expense-form" id="expense-form">
                        <div class="expense-grid">
                            <label>
                                <span>Title</span>
                                <input type="text" id="expense-title" placeholder="Groceries, rent, supplies..." required />
                            </label>
                            <label>
                                <span>Amount</span>
                                <input type="number" id="expense-amount" placeholder="0" min="0" step="0.01" required />
                            </label>
                            <label>
                                <span>Category</span>
                                <select id="expense-category">
                                    <option value="shop">Shop</option>
                                    <option value="personal">Personal</option>
                                    <option value="inventory">Inventory</option>
                                    <option value="rent">Rent</option>
                                    <option value="utilities">Utilities</option>
                                    <option value="other">Other</option>
                                </select>
                            </label>
                        </div>
                        <label>
                            <span>Note (optional)</span>
                            <input type="text" id="expense-note" placeholder="Short note" />
                        </label>
                        <div class="expense-actions">
                            <button type="submit" class="primary-btn">Add expense</button>
                            <button type="button" class="secondary-btn" id="expense-export-btn">Export expenses (CSV)</button>
                        </div>
                    </form>
                    <div class="data-empty" id="expenses-empty" hidden>
                        <p>No expenses yet. Add your first expense.</p>
                    </div>
                    <div class="expense-list" id="expense-list" aria-live="polite"></div>
                </div>
            </section>

            <section class="panel" id="panel-bill" aria-label="Generate Bill">
                <div class="panel-header">
                    <div>
                        <h1>Generate Bill</h1>
                        <p class="panel-subtitle">Create professional invoices</p>
                    </div>
                </div>
                <div class="bill-panel-content">
                    <p style="text-align: center; color: var(--text-soft); margin: 40px 0;">Select a customer from the list to generate a bill, or use the quick bill generator below.</p>
                    <button class="primary-btn" id="quick-bill-btn" style="width: 100%; margin-bottom: 20px;">Quick Generate Bill</button>
                </div>
            </section>

            <section class="panel" id="panel-ai" aria-label="AI Buddy Optichain">
                <div class="panel-header">
                    <div>
                        <h1>Optichain AI</h1>
                        <p class="panel-subtitle" data-i18n="ai.subtitle">Your intelligent assistant for business insights</p>
                    </div>
                </div>

            <div class="ai-insights" id="ai-insights">
                <div class="insight-card">
                    <p>Highest balance</p>
                    <strong id="insight-highest-debt">‡ß≥0</strong>
                    <small>Collect sooner</small>
                </div>
                <div class="insight-card">
                    <p>Task completion</p>
                    <strong id="insight-task-completion">0%</strong>
                    <small>Across due dates</small>
                </div>
                <div class="insight-card">
                    <p>AI tip</p>
                    <small id="insight-ai-tip">Ask Optichain for help</small>
                </div>
            </div>

                <div class="ai-tools-tabs">
                    <button class="ai-tab active" data-tab="chat">Chat</button>
                    <button class="ai-tab" data-tab="calculator">Calculator</button>
                    <button class="ai-tab" data-tab="cards">Payment Cards</button>
                </div>

                <div class="ai-tab-content active" data-content="chat">
                    <div class="ai-chat-wrapper">
                        <div class="ai-chat-header">
                            <div class="ai-avatar">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
                                    <polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline>
                                    <line x1="12" y1="22.08" x2="12" y2="12"></line>
                                </svg>
                            </div>
                            <div class="ai-header-text">
                                <h3>Optichain AI</h3>
                                <p>Your intelligent business assistant</p>
                            </div>
                        </div>
                        <div class="ai-messages-container" id="ai-messages">
                            <div class="ai-welcome-message">
                                <div class="welcome-icon">‚ú®</div>
                                <h3>How can I help you today?</h3>
                                <p>Ask me anything about your business, customers, or tasks.</p>
                            </div>
                        </div>
                        <div class="ai-quick-suggestions" id="ai-quick-suggestions">
                            <button class="suggestion-chip" data-action="find-customer">
                                <span>üîç</span>
                                <span>Find Customer</span>
                            </button>
                            <button class="suggestion-chip" data-action="trust-ratio">
                                <span>üìä</span>
                                <span>Trust Ratio</span>
                            </button>
                            <button class="suggestion-chip" data-action="plan-day">
                                <span>üìÖ</span>
                                <span>Plan Day</span>
                            </button>
                            <button class="suggestion-chip" data-action="add-task">
                                <span>‚úÖ</span>
                                <span>Add Task</span>
                            </button>
                        </div>
                        <div class="ai-input-wrapper">
                            <div class="ai-input-box">
                                <textarea id="ai-input" rows="1" placeholder="Message Optichain..." data-i18n-placeholder="ai.placeholder"></textarea>
                                <button class="ai-send-button" id="ai-send-btn" aria-label="Send" disabled>
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                                        <line x1="22" y1="2" x2="11" y2="13"></line>
                                        <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                                    </svg>
                                </button>
                            </div>
                            <p class="ai-input-hint">Optichain can make mistakes. Check important info.</p>
                        </div>
                    </div>
                </div>

                <div class="ai-tab-content" data-content="calculator">
                    <div class="calculator-container">
                        <div class="calculator-display" id="calculator-display">0</div>
                        <div class="calculator-buttons">
                            <button class="calc-btn calc-clear" data-action="clear">C</button>
                            <button class="calc-btn calc-clear" data-action="clear-entry">CE</button>
                            <button class="calc-btn calc-operator" data-action="backspace">‚å´</button>
                            <button class="calc-btn calc-operator" data-value="/">√∑</button>
                            <button class="calc-btn calc-number" data-value="7">7</button>
                            <button class="calc-btn calc-number" data-value="8">8</button>
                            <button class="calc-btn calc-number" data-value="9">9</button>
                            <button class="calc-btn calc-operator" data-value="*">√ó</button>
                            <button class="calc-btn calc-number" data-value="4">4</button>
                            <button class="calc-btn calc-number" data-value="5">5</button>
                            <button class="calc-btn calc-number" data-value="6">6</button>
                            <button class="calc-btn calc-operator" data-value="-">‚àí</button>
                            <button class="calc-btn calc-number" data-value="1">1</button>
                            <button class="calc-btn calc-number" data-value="2">2</button>
                            <button class="calc-btn calc-number" data-value="3">3</button>
                            <button class="calc-btn calc-operator" data-value="+">+</button>
                            <button class="calc-btn calc-number calc-zero" data-value="0">0</button>
                            <button class="calc-btn calc-number" data-value=".">.</button>
                            <button class="calc-btn calc-equals" data-action="equals">=</button>
                        </div>
                    </div>
                </div>

                <div class="ai-tab-content" data-content="cards">
                    <div class="card-generator-container">
                        <div class="card-preview" id="payment-card-preview">
                            <div class="payment-card">
                                <div class="payment-card-header">
                                    <img id="card-shop-image" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='60' height='60'%3E%3C/svg%3E" alt="Shop" class="card-shop-image" style="display: none;" />
                                    <div>
                                        <h3 id="card-shop-name">Your Shop</h3>
                                        <p class="card-subtitle" data-i18n="card.paymentRequest">Payment Request</p>
                                    </div>
                                </div>
                                <div class="payment-card-body">
                                    <div class="card-amount">
                                        <span class="card-label" data-i18n="card.amountDue">Amount Due</span>
                                        <span class="card-value" id="card-amount">‡ß≥0</span>
                                    </div>
                                    <div class="card-message" id="card-message">Thank you for your business!</div>
                                    <div class="card-payment-methods" id="card-payment-methods">
                                        <div class="payment-method">
                                            <span>üì±</span>
                                            <span>+880 1234 567890</span>
                                        </div>
                                        <div class="payment-method">
                                            <span>üè¶</span>
                                            <span>Bank Account</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="card-generator-form">
                            <label>
                                <span data-i18n="card.selectCustomer">Select Customer</span>
                                <select id="card-customer-select">
                                    <option value="">-- Select Customer --</option>
                                </select>
                            </label>
                            <label>
                                <span data-i18n="card.message">Message (optional)</span>
                                <textarea id="card-message-input" rows="3" placeholder="Custom message for customer..."></textarea>
                            </label>
                            <label>
                                <span data-i18n="card.paymentMethods">Payment Methods</span>
                                <div class="payment-methods-input">
                                    <input type="text" id="card-phone-input" placeholder="Phone/Account Number" />
                                    <input type="text" id="card-bank-input" placeholder="Bank/Other Info" />
                                </div>
                            </label>
                            <div class="card-actions">
                                <button class="secondary-btn" id="card-generate-btn" data-i18n="card.generate">Generate Card</button>
                                <button class="primary-btn" id="card-download-btn" data-i18n="card.download">Download Image</button>
                                <button class="secondary-btn" id="card-share-btn" data-i18n="card.share">Share</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="panel" id="panel-settings" aria-label="Settings">
                <div class="panel-header">
                    <div>
                        <h1 data-i18n="settings.title">Settings</h1>
                        <p class="panel-subtitle" data-i18n="settings.subtitle">Manage your preferences</p>
                    </div>
                </div>

                <div class="settings-content">
                    <div class="settings-section">
                        <h2 data-i18n="settings.shop.title">Shop Information</h2>
                        <div class="settings-option">
                            <label>
                                <span data-i18n="settings.shop.name">Shop Name</span>
                                <input type="text" id="settings-shop-name" class="settings-input" placeholder="Enter shop name" />
                            </label>
                        </div>
                        <div class="settings-option">
                            <label>
                                <span data-i18n="settings.shop.image">Shop Image/Logo</span>
                                <input type="file" id="settings-shop-image" accept="image/*" class="settings-file-input" />
                                <div class="shop-image-preview" id="shop-image-preview"></div>
                            </label>
                        </div>
                        <div class="settings-option">
                            <label>
                                <span data-i18n="settings.shop.phone">Phone Number</span>
                                <input type="tel" id="settings-shop-phone" class="settings-input" placeholder="+880 1234 567890" />
                            </label>
                        </div>
                        <div class="settings-option">
                            <label>
                                <span data-i18n="settings.shop.bank">Bank Account (optional)</span>
                                <input type="text" id="settings-shop-bank" class="settings-input" placeholder="Bank account or other payment info" />
                            </label>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h2 data-i18n="settings.language.title">Language</h2>
                        <div class="settings-option">
                            <label>
                                <span data-i18n="settings.language.label">Select Language</span>
                                <select id="settings-language" class="settings-select">
                                    <option value="en">English</option>
                                    <option value="bn">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ</option>
                                </select>
                            </label>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h2 data-i18n="settings.notifications.title">Notifications</h2>
                        <div class="settings-option">
                            <label class="settings-toggle-label">
                                <input type="checkbox" id="settings-notifications" />
                                <span data-i18n="settings.notifications.enable">Enable reminders</span>
                            </label>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h2>Login & Security</h2>
                        <p class="panel-subtitle" style="margin-bottom:12px;">Optional login controls (available only from Settings).</p>
                        <div class="settings-option">
                            <label>
                                <span>Email (optional)</span>
                                <input type="email" id="settings-login-email" class="settings-input" placeholder="name@email.com" />
                            </label>
                        </div>
                        <div class="settings-option">
                            <label>
                                <span>Password (optional)</span>
                                <input type="password" id="settings-login-password" class="settings-input" placeholder="Set a password" />
                            </label>
                        </div>
                        <div class="settings-option">
                            <label>
                                <span>Passcode (4-6 digits)</span>
                                <input type="password" id="settings-login-passcode" class="settings-input" inputmode="numeric" pattern="[0-9]*" maxlength="6" placeholder="1234" />
                            </label>
                        </div>
                        <div class="settings-actions-row">
                            <button class="primary-btn" id="settings-login-save-btn">Save login info</button>
                            <button class="secondary-btn" id="settings-login-clear-btn">Clear login</button>
                        </div>
                        <div class="settings-option" style="margin-top:10px;">
                            <label class="settings-toggle-label">
                                <input type="checkbox" id="settings-login-require-toggle" />
                                <span>Require login on next open (optional)</span>
                            </label>
                            <p class="hint-text">App opens without login by default; toggle this only if you want a lock.</p>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h2 data-i18n="settings.display.title">Display</h2>
                        <div class="settings-option">
                            <label>
                                <span data-i18n="settings.display.fontSize">Font Size</span>
                                <div class="font-size-control">
                                    <button class="font-size-btn" data-size="smaller" aria-label="Smaller">A</button>
                                    <button class="font-size-btn" data-size="small" aria-label="Small">A</button>
                                    <button class="font-size-btn active" data-size="medium" aria-label="Medium">A</button>
                                    <button class="font-size-btn" data-size="large" aria-label="Large">A</button>
                                </div>
                            </label>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h2 data-i18n="settings.theme.title">Theme</h2>
                        <div class="theme-selector">
                            <button class="theme-btn" data-theme="light" data-i18n="settings.theme.light">Light</button>
                            <button class="theme-btn" data-theme="dark" data-i18n="settings.theme.dark">Dark</button>
                            <button class="theme-btn" data-theme="zen" data-i18n="settings.theme.zen">Zen</button>
                            <button class="theme-btn" data-theme="cozy" data-i18n="settings.theme.cozy">Cozy</button>
                            <button class="theme-btn" data-theme="ocean" data-i18n="settings.theme.ocean">Ocean</button>
                            <button class="theme-btn" data-theme="forest" data-i18n="settings.theme.forest">Forest</button>
                            <button class="theme-btn" data-theme="sunset" data-i18n="settings.theme.sunset">Sunset</button>
                            <button class="theme-btn" data-theme="lavender" data-i18n="settings.theme.lavender">Lavender</button>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h2>About</h2>
                        <div class="about-content">
                            <p style="margin: 0 0 12px; line-height: 1.6;">
                                <strong>Made by Cozytustudios</strong><br>
                                Founder: <strong>Sajid Hossain</strong>
                            </p>
                            <p style="margin: 0; color: var(--text-soft); font-size: 0.9rem;">
                                Debtx - Your digital khata for managing customer debts and payments.
                            </p>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h2>Monthly Wrapped</h2>
                        <div class="settings-option">
                            <p style="margin: 0 0 12px; color: var(--text-soft);">View your monthly summary and insights</p>
                            <button class="primary-btn" id="view-monthly-wrapped-btn">View Monthly Wrapped</button>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h2>Data Backup & Export</h2>
                        <p class="panel-subtitle" style="margin-bottom:12px;">Export/import all your data (customers, notes, tasks, expenses, settings).</p>
                        <div class="settings-actions-row">
                            <button class="primary-btn" id="data-export-btn">Export all data (JSON)</button>
                            <button class="secondary-btn" id="data-import-btn">Import data</button>
                        </div>
                        <input type="file" id="data-import-file" accept="application/json" style="display:none;" />
                        <div class="settings-actions-row" style="margin-top:10px;">
                            <button class="secondary-btn" id="download-bill-png-btn">Download bill PNG</button>
                        </div>
                        <p class="hint-text" style="margin-top:10px;">Exports include everything stored in the app. Bill PNG uses your current bill design.</p>
                    </div>

                    <div class="settings-section">
                        <h2 data-i18n="settings.subscription.title">Subscription</h2>
                        <div id="subscription-status" class="subscription-status"></div>
                        <div class="premium-benefits">
                            <h3 style="margin: 0 0 16px; color: var(--primary);">‚ú® Pro Benefits</h3>
                            <ul class="benefits-list">
                                <li>‚úì Unlimited customers</li>
                                <li>‚úì Payment card generation</li>
                                <li>‚úì Advanced analytics</li>
                                <li>‚úì Priority support</li>
                                <li>‚úì Export data</li>
                                <li>‚úì Custom themes</li>
                                    <li>‚úì AI-guided reminders</li>
                                    <li>‚úì Notes & task sync</li>
                            </ul>
                        </div>
                        <div class="subscription-plans">
                            <div class="subscription-plan">
                                <h3>Pro</h3>
                                <div class="plan-price">‡ß≥40/‡¶Æ‡¶æ‡¶∏</div>
                                <ul class="plan-features">
                                    <li>Unlimited customers</li>
                                    <li>Payment cards</li>
                                    <li>Advanced features</li>
                                </ul>
                                <button class="primary-btn" id="buy-pro-btn" data-plan="pro">Buy Pro</button>
                            </div>
                            <div class="subscription-plan featured">
                                <h3>Max</h3>
                                <div class="plan-price">‡ß≥300/‡¶¨‡¶õ‡¶∞</div>
                                <ul class="plan-features">
                                    <li>All Pro features</li>
                                    <li>Priority support</li>
                                    <li>Early access</li>
                                    <li>Best value</li>
                                </ul>
                                <button class="primary-btn" id="buy-max-btn" data-plan="max">Buy Max</button>
                            </div>
                        </div>
                        <div class="settings-option" style="margin-top: 20px;">
                            <button class="secondary-btn" id="cancel-premium-btn" style="width: 100%;">Cancel Premium</button>
                        </div>
                        <div class="settings-option" style="margin-top: 20px;">
                            <label>
                                <span>Enter Coupon Code</span>
                                <div style="display: flex; gap: 10px;">
                                    <input type="text" id="subscription-coupon" class="settings-input" placeholder="Coupon code" />
                                    <button class="secondary-btn" id="apply-coupon-btn">Apply</button>
                                </div>
                            </label>
                        </div>
                        <div class="settings-option" style="margin-top: 20px;">
                            <label>
                                <span>Premium JSON (Import/Export)</span>
                                <div style="display: flex; gap: 10px; flex-direction: column;">
                                    <button class="secondary-btn" id="export-premium-btn">Export Premium JSON</button>
                                    <input type="file" id="import-premium-file" accept=".json" style="display: none;" />
                                    <button class="secondary-btn" id="import-premium-btn">Import Premium JSON</button>
                                </div>
                            </label>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <nav class="app-nav" aria-label="Main sections">
            <button class="nav-btn active" data-target="customers" id="nav-customers" aria-label="Customers">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                    <circle cx="9" cy="7" r="4"></circle>
                    <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                    <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                </svg>
                <span class="nav-label" data-i18n="nav.customers">Customers</span>
            </button>
            <button class="nav-btn" data-target="notes" id="nav-notes" aria-label="Notes">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                    <polyline points="14 2 14 8 20 8"></polyline>
                    <line x1="16" y1="13" x2="8" y2="13"></line>
                    <line x1="16" y1="17" x2="8" y2="17"></line>
                    <polyline points="10 9 9 9 8 9"></polyline>
                </svg>
                <span class="nav-label" data-i18n="nav.notes">Notes</span>
            </button>
            <button class="nav-btn" data-target="tasks" id="nav-tasks" aria-label="To-Do">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                    <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
                </svg>
                <span class="nav-label" data-i18n="nav.tasks">To-Do</span>
            </button>
            <button class="nav-btn" data-target="ai" id="nav-ai" aria-label="AI Buddy">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
                    <polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline>
                    <line x1="12" y1="22.08" x2="12" y2="12"></line>
                    <circle cx="12" cy="12" r="2.5" fill="currentColor" opacity="0.8"></circle>
                </svg>
                <span class="nav-label" data-i18n="nav.ai">AI</span>
            </button>
            <button class="nav-btn" data-target="bill" id="nav-bill" aria-label="Generate Bill">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                    <polyline points="14 2 14 8 20 8"></polyline>
                    <line x1="16" y1="13" x2="8" y2="13"></line>
                    <line x1="16" y1="17" x2="8" y2="17"></line>
                    <polyline points="10 9 9 9 8 9"></polyline>
                </svg>
                <span class="nav-label">Bill</span>
            </button>
        </nav>

    </div>

    <dialog class="modal" id="customer-modal" aria-labelledby="customer-modal-title">
        <form class="modal-form" id="customer-form">
            <h2 id="customer-modal-title" data-i18n="modals.customer.title">Add Customer</h2>
            <label>
                <span data-i18n="modals.customer.name">Customer Name</span>
                <input type="text" name="name" required maxlength="60" />
            </label>
            <label>
                <span data-i18n="modals.customer.phone">Phone Number (optional)</span>
                <input type="tel" name="phone" maxlength="15" />
            </label>
            <label>
                <span data-i18n="modals.customer.repayDays">Repayment window (days)</span>
                <input type="number" name="repaymentDays" min="1" max="90" value="7" />
            </label>
            <label>
                <span data-i18n="modals.customer.note">Note</span>
                <textarea name="note" rows="2" maxlength="140"></textarea>
            </label>
            <div class="modal-actions">
                <button type="button" class="secondary-btn" data-close data-i18n="actions.cancel">Cancel</button>
                <button type="submit" class="primary-btn" data-i18n="actions.save">Save</button>
            </div>
        </form>
    </dialog>

    <dialog class="modal" id="debt-modal" aria-labelledby="debt-modal-title">
        <form class="modal-form" id="debt-form">
            <h2 id="debt-modal-title" data-i18n="modals.debt.title">Record Debt</h2>
            <input type="hidden" name="customerId" />
            <label>
                <span data-i18n="modals.debt.amount">Debt Amount (‡ß≥)</span>
                <input type="number" name="amount" min="1" step="1" required />
            </label>
            <label>
                <span data-i18n="modals.debt.description">Description</span>
                <textarea name="description" rows="2" maxlength="140"></textarea>
            </label>
            <label>
                <span data-i18n="modals.debt.date">Date</span>
                <input type="date" name="date" required />
            </label>
            <div class="modal-actions">
                <button type="button" class="secondary-btn" data-close data-i18n="actions.cancel">Cancel</button>
                <button type="submit" class="primary-btn" data-i18n="actions.save">Save</button>
            </div>
        </form>
    </dialog>

    <dialog class="modal" id="payment-modal" aria-labelledby="payment-modal-title">
        <form class="modal-form" id="payment-form">
            <h2 id="payment-modal-title" data-i18n="modals.payment.title">Record Payment</h2>
            <input type="hidden" name="customerId" />
            <label>
                <span data-i18n="modals.payment.amount">Payment Amount (‡ß≥)</span>
                <input type="number" name="amount" min="1" step="1" required />
            </label>
            <label>
                <span data-i18n="modals.payment.date">Date</span>
                <input type="date" name="date" required />
            </label>
            <label>
                <span data-i18n="modals.payment.note">Note</span>
                <textarea name="note" rows="2" maxlength="140"></textarea>
            </label>
            <div class="modal-actions">
                <button type="button" class="secondary-btn" data-close data-i18n="actions.cancel">Cancel</button>
                <button type="submit" class="primary-btn" data-i18n="actions.save">Save</button>
            </div>
        </form>
    </dialog>

    <dialog class="modal" id="note-modal" aria-labelledby="note-modal-title">
        <form class="modal-form" id="note-form">
            <h2 id="note-modal-title" data-i18n="modals.note.title">New Note</h2>
            <label>
                <span data-i18n="modals.note.titleLabel">Title</span>
                <input type="text" name="title" maxlength="80" required />
            </label>
            <label>
                <span data-i18n="modals.note.body">Note</span>
                <textarea name="body" rows="4" maxlength="400"></textarea>
            </label>
            <div class="modal-actions">
                <button type="button" class="secondary-btn" data-close data-i18n="actions.cancel">Cancel</button>
                <button type="submit" class="primary-btn" data-i18n="actions.save">Save</button>
            </div>
        </form>
    </dialog>

    <dialog class="modal" id="task-modal" aria-labelledby="task-modal-title">
        <form class="modal-form" id="task-form">
            <h2 id="task-modal-title" data-i18n="modals.task.title">Add Task</h2>
            <label>
                <span data-i18n="modals.task.name">Task Name</span>
                <input type="text" name="name" maxlength="80" required />
            </label>
            <label>
                <span data-i18n="modals.task.type">Type</span>
                <select name="type">
                    <option value="payment" data-i18n="modals.task.typePayment">Payment Follow-up</option>
                    <option value="delivery" data-i18n="modals.task.typeDelivery">Delivery</option>
                    <option value="purchase" data-i18n="modals.task.typePurchase">Stock Purchase</option>
                    <option value="other" data-i18n="modals.task.typeOther">Other</option>
                </select>
            </label>
            <label>
                <span data-i18n="modals.task.date">Due Date</span>
                <input type="date" name="dueDate" required />
            </label>
            <label>
                <span data-i18n="modals.task.note">Note</span>
                <textarea name="note" rows="2" maxlength="140"></textarea>
            </label>
            <div class="modal-actions">
                <button type="button" class="secondary-btn" data-close data-i18n="actions.cancel">Cancel</button>
                <button type="submit" class="primary-btn" data-i18n="actions.save">Save</button>
            </div>
        </form>
    </dialog>

    <dialog class="modal bill-modal" id="bill-modal" aria-labelledby="bill-modal-title">
        <form class="modal-form" id="bill-form">
            <div class="bill-header">
                <h2 id="bill-modal-title">Generate Bill</h2>
                <p style="color: var(--text-soft); margin: 8px 0 0;">Create professional invoices</p>
            </div>
            <div class="bill-form-grid">
                <label>
                    <span>Select Customer</span>
                    <select id="bill-customer-select" required>
                        <option value="">-- Select Customer --</option>
                    </select>
                </label>
                <label>
                    <span>Bill Date</span>
                    <input type="date" id="bill-date" required />
                </label>
            </div>
            <div class="bill-items-section">
                <div class="bill-section-header">
                    <h3>Items</h3>
                    <button type="button" class="secondary-btn small-btn" id="add-bill-item-btn">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="12" y1="5" x2="12" y2="19"></line>
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                        </svg>
                        Add Item
                    </button>
                </div>
                <div id="bill-items-container">
                    <div class="bill-item">
                        <label>
                            <span>Product/Service</span>
                            <input type="text" class="bill-item-name" placeholder="Item name" required />
                        </label>
                        <label>
                            <span>Quantity</span>
                            <input type="number" class="bill-item-qty" min="1" value="1" required />
                        </label>
                        <label>
                            <span>Price (‡ß≥)</span>
                            <input type="number" class="bill-item-price" min="0" step="0.01" required />
                        </label>
                        <label>
                            <span>Total</span>
                            <input type="text" class="bill-item-total" readonly value="‡ß≥0" />
                        </label>
                    </div>
                </div>
            </div>
            <div class="bill-summary">
                <div class="bill-summary-row">
                    <span>Subtotal:</span>
                    <span id="bill-subtotal">‡ß≥0</span>
                </div>
                <div class="bill-summary-row">
                    <span>Tax (0%):</span>
                    <span id="bill-tax">‡ß≥0</span>
                </div>
                <div class="bill-summary-row total-row">
                    <span>Total:</span>
                    <span id="bill-total">‡ß≥0</span>
                </div>
            </div>
            <div class="modal-actions">
                <button type="button" class="secondary-btn" data-close>Cancel</button>
                <button type="button" class="secondary-btn" id="preview-bill-btn">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                        <circle cx="12" cy="12" r="3"></circle>
                    </svg>
                    Preview
                </button>
                <button type="button" class="primary-btn" id="generate-bill-pdf-btn">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="7 10 12 15 17 10"></polyline>
                        <line x1="12" y1="15" x2="12" y2="3"></line>
                    </svg>
                    Download PDF
                </button>
            </div>
        </form>
    </dialog>

    <dialog class="modal" id="monthly-wrapped-modal" aria-labelledby="monthly-wrapped-title">
        <div class="modal-form">
            <h2 id="monthly-wrapped-title">Monthly Wrapped</h2>
            <div id="monthly-wrapped-content" style="max-height: 70vh; overflow-y: auto;">
                <!-- Content will be generated dynamically -->
            </div>
            <div class="modal-actions">
                <button type="button" class="secondary-btn" data-close>Close</button>
                <button type="button" class="primary-btn" id="share-wrapped-btn">Share</button>
            </div>
        </div>
    </dialog>

    <dialog class="modal" id="customize-card-modal" aria-labelledby="customize-card-title">
        <form class="modal-form">
            <h2 id="customize-card-title">Customize Payment Card</h2>
            <input type="hidden" id="customize-customer-id" />
            <label>
                <span>Card Background</span>
                <div class="card-background-options">
                    <button type="button" class="bg-option active" data-bg="gradient-primary" style="background: var(--gradient-primary);"></button>
                    <button type="button" class="bg-option" data-bg="gradient-accent" style="background: var(--gradient-accent);"></button>
                    <button type="button" class="bg-option" data-bg="blue" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);"></button>
                    <button type="button" class="bg-option" data-bg="purple" style="background: linear-gradient(135deg, #8b5cf6 0%, #ec4899 100%);"></button>
                    <button type="button" class="bg-option" data-bg="green" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%);"></button>
                    <button type="button" class="bg-option" data-bg="orange" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);"></button>
                </div>
            </label>
            <label>
                <span>Custom Background Color</span>
                <input type="color" id="custom-bg-color" value="#1c8b73" />
            </label>
            <div class="card-preview-mini" id="card-preview-mini">
                <!-- Preview will be generated -->
            </div>
            <div class="modal-actions">
                <button type="button" class="secondary-btn" data-close>Cancel</button>
                <button type="button" class="primary-btn" id="apply-card-customization-btn">Apply</button>
                <button type="button" class="secondary-btn" id="download-customized-card-btn">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="7 10 12 15 17 10"></polyline>
                        <line x1="12" y1="15" x2="12" y2="3"></line>
                    </svg>
                    Download
                </button>
            </div>
        </form>
    </dialog>

    <template id="customer-card-template">
        <article class="customer-card" data-customer-id="">
            <header class="customer-card__header">
                <div>
                    <h2 class="customer-name"></h2>
                    <p class="customer-phone"></p>
                </div>
                <div class="customer-status">
                    <span class="status-pill"></span>
                    <span class="status-text"></span>
                </div>
            </header>
            <div class="customer-card__body">
                <div class="balance-row">
                    <span data-i18n="customers.card.balance">Balance</span>
                    <strong class="customer-balance">‡ß≥0</strong>
                </div>
                <div class="meta-grid">
                    <div>
                        <span data-i18n="customers.card.lastPayment">Last payment</span>
                        <p class="customer-last-payment">‚Äî</p>
                    </div>
                    <div>
                        <span data-i18n="customers.card.dueDate">Due date</span>
                        <p class="customer-due-date">‚Äî</p>
                    </div>
                </div>
                <p class="customer-note"></p>
            </div>
            <footer class="customer-card__footer">
                <button class="secondary-btn" data-action="history" data-i18n="customers.card.history">History</button>
                <button class="secondary-btn" data-action="payment" data-i18n="customers.card.payment">Payment</button>
                <button class="primary-btn" data-action="debt" data-i18n="customers.card.debt">Add Debt</button>
                <div class="card-actions-menu">
                    <button class="secondary-btn" data-action="customize-card" title="Customize Card">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 20h9"></path>
                            <path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"></path>
                        </svg>
                    </button>
                    <button class="secondary-btn" data-action="download-card" title="Download Card">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="7 10 12 15 17 10"></polyline>
                            <line x1="12" y1="15" x2="12" y2="3"></line>
                        </svg>
                    </button>
                    <button class="secondary-btn danger-btn" data-action="delete-customer" title="Delete Customer">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="3 6 5 6 21 6"></polyline>
                            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                        </svg>
                    </button>
                </div>
            </footer>
            <div class="customer-history" hidden>
                <h3 data-i18n="customers.card.historyTitle">Activity</h3>
                <ul class="history-list"></ul>
            </div>
        </article>
    </template>

    <template id="note-card-template">
        <article class="note-card" data-note-id="">
            <header>
                <h2 class="note-title"></h2>
                <time class="note-date"></time>
            </header>
            <p class="note-body"></p>
            <footer>
                <button class="secondary-btn" data-action="delete" data-i18n="actions.delete">Delete</button>
            </footer>
        </article>
    </template>

    <template id="task-card-template">
        <article class="task-card" data-task-id="">
            <header>
                <div>
                    <h2 class="task-name"></h2>
                    <p class="task-type"></p>
                </div>
                <label class="task-status">
                    <input type="checkbox" />
                    <span data-i18n="tasks.card.done">Done</span>
                </label>
            </header>
            <div class="task-body">
                <div class="task-due">
                    <span data-i18n="tasks.card.due">Due</span>
                    <time class="task-date"></time>
                </div>
                <div class="task-pay-info" id="task-pay-info"></div>
                <p class="task-note"></p>
            </div>
            <footer>
                <button class="secondary-btn" data-action="delete" data-i18n="actions.delete">Delete</button>
            </footer>
        </article>
    </template>

    <script src="app.js" defer></script>
</body>
</html>


    <script src="app.js" defer></script>
</body>
</html>
